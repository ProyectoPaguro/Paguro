{% extends "base.html" %}
{% block titulo %}Producci贸n{% endblock %}

{% block contenido %}
<div class="container mt-4">
  <h2 class="mb-4 text-primary">Producci贸n</h2>

  <!--  Encabezado con bot贸n de nuevo producto -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="text-secondary mb-0">Categor铆as de Producci贸n</h4>

    {% if current_user.is_authenticated and current_user.rol == 'admin' %}
      <a href="{{ url_for('crear_producto') }}" class="btn btn-success">Nuevo producto</a>
    {% endif %}
  </div>

  <!--  PANEL VISUAL DE CATEGORAS -->
  <div class="row">
    {% for id, nombre, total in totales_categoria %}
    {% set base = 'img/categorias/' + nombre|lower|replace(' ', '-') %}
    <div class="col-md-3 mb-4">
      <div id="cat-{{ id }}" class="card shadow-sm border-0 text-center h-100 categoria-card"
           style="cursor:pointer;"
           onclick="window.location.href='{{ url_for('produccion_categoria', id_categoria=id) }}'">

        {% set base = 'img/categorias/' + nombre|lower|replace(' ', '-') %}
        {% set img_jpg = base + '.jpg' %}
        {% set img_default = 'img/categorias/default.jpg' %}

        <img 
          src="{{ url_for('static', filename=img_jpg) }}"
          onerror="this.src='{{ url_for('static', filename=img_default) }}'"
          class="card-img-top"
          alt="{{ nombre }}"
          style="object-fit: cover; height: 200px; border-top-left-radius: 1rem; border-top-right-radius: 1rem;"
        >

        <!--  Contenido -->
        <div class="card-body">
          <h5 class="card-title">{{ nombre }}</h5>
          <p class="text-muted mb-0">Total: <strong>{{ total }}</strong></p>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!--  Estilos -->
<style>
.categoria-card:hover {
  transform: scale(1.02);
  transition: all 0.2s;
  box-shadow: 0 0 10px rgba(0,0,0,0.15);
}
</style>

{% endblock %}
